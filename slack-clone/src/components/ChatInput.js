import React, { useRef, useState } from "react";
import styled from "styled-components";
import { Button } from "@material-ui/core";
import { db } from "../firebase";
import firebase from "firebase";

function ChatInput({ channelName, channelId, chatRef }) {
  const [input, setInput] = useState("");

  console.log(channelId);
  const sendMessage = (e) => {
    e.preventDefault(); // Prevents refresh

    if (!channelId) {
      return false;
    }

    db.collection("rooms").doc(channelId).collection("messages").add({
      message: input,
      timestamp: firebase.firestore.FieldValue.serverTimestamp(),
      user: "Meowmeow",
      userImage:
        "data:image/jpeg;base64,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",
      // "https://pbs.twimg.com/profile_images/1339192504382590976/2WxMn8cm_400x400.jpg",
    });

    chatRef.current.scrollIntoView({
      behavior: "smooth",
    });

    setInput("");
  };

  return (
    <ChatInputContainer>
      <form>
        <input
          value={input}
          onChange={(e) => setInput(e.target.value)}
          placeholder={`Message #${channelName}`}
        />
        <Button hidden type="submit" onClick={sendMessage}>
          SEND
        </Button>
      </form>
    </ChatInputContainer>
  );
}

export default ChatInput;

const ChatInputContainer = styled.div`
  border-radius: 20px;

  > form {
    position: relative;
    display: flex;
    justify-content: center;
  }
  > form > input {
    position: fixed;
    bottom: 30px;
    width: 60%;
    border: 1px solid gray;
    border-radius: 3px;
    padding: 20px;
    outline: none;
  }
  > form > button {
    display: none !important;
  }
`;
